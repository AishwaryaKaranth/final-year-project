## ABSTRACT
There are millions of huge collections of stars, gas, dust and stellar remnants all held together by gravity in our vast universe. These collections, or galaxies, help in deciphering the structure and history of the universe in general. The classification of these galaxies based on morphological parameters is a relevant requirement in understanding their formation and evolution. Manual identification of the categories to which each belongs to can be tiresome, time consuming and error prone. The objective of our work was to automate the process of finding the features that characterise a galaxy using convolutional neural networks, a cardinal concept in the image data space, whilst comparing the accuracy of the classification with and without prior processing of the image dataset. The Galaxy Zoo dataset was used for the same and it was preprocessed by applying median filtering and contrast limited adaptive histogram equalisation. The final classification model was a CNN based on the VGG-16 architecture with some modifications. We considered all 37 features as per the decision tree by Willet et. al. and with a multi-regression approach, obtained a model with a validation loss of 0.0102 (mean square error) on processed images as the best performing model. The model was then deployed onto a client-side interface using Flask to predict the features of the galaxies in real-time.

## INTRODUCTION
Galaxies are the fundamental elements of the universe and the understanding of their origin and evolution is an integral part of physical cosmology. There are an uncountable number of galaxies in the cosmos, with billions not even discovered yet. The structural or morphological properties of galaxies hold the key to the deeper understanding of the process of galactic evolution. The study of the same comprises a rich history in the field of astrophysics, while answering many questions about the universe as we know it. 
The databases are generated by telescopes at an ever-increasing speed which reinforces the need for computer analysis of the images. The expanding image databases of astronomical objects such as galaxies render the process of manual methods for classification of the same as almost impossible. Experts would require enormous amounts of time to manually categorise the images of the galaxies or find the finer physical features that describe a galaxy. This led to a dire need for the creation of automated means to do the same. 
Some of the most famous datasets used by related works include the Galaxy Zoo dataset, and the Sloan Digital Sky Survey (SDSS) which is possibly the largest astronomical survey. Other data sources include - Zsolt Frei’s catalogue [3], EFIGI catalogue [8], the NGC catalogue [16], etc. Some of them went with a custom dataset constituting a random collection of images from Google [1] and other sources. After the collection of the images, the next step is to rid the images of any unwanted and hindering distortions that exist. Image preprocessing is a vital step in image enhancement which aids in the deduction of important features and inferences. Another important step is data augmentation which is performed in order to introduce more variety into the training data for the reduction of overfitting. Once the data is well prepared comes the actual process of classification. This process involves the fields of Machine Learning and Deep Learning, the flag-bearers of automating methods that require human intervention. The related works have used multiple algorithms of ML and DL. The ML methods previously tested include Support Vector Machines, Random Forest classifier, Naive Bayes classifier, K-Nearest Neighbours and Adaboost classifier [2],[3]. The DL algorithms in the related works are Artificial Neural Networks [15], and mainly different architectures of Convolutional Neural Networks such as Inception Module [1], Resnet [9], etc. Performance wise, DL fared better than ML. Some works worked on a three-category classification (Elliptical, Spiral, Irregular) [1] and some others worked on a five-category classification [2],[9]. A few works have used the Willett et.al. decision tree [21] for attempts in discovering the finer features that describe a galaxy, but some of them have cut the tree short so as to not consider all the possible features. This decision tree was also used as a reference in the famous Galaxy Zoo challenge on Kaggle which over 326 teams participating in the classification of galaxies. 
Our work on galaxy morphology classification is described in the following sections, which include the dataset under consideration, the preprocessing techniques involved, the models trained and its performance. The objective of this work is to achieve a model with a low loss using Convolutional Neural Networks, a cardinal concept in image classification, to predict the probabilities with which features characterise a given galaxy, with a multi-regression approach to the problem statement.  

## MODEL ARCHITECTURE
Our work made use of a Convolutional Neural Network for the classification process. CNNs are a class of Deep Learning algorithms that constitute convolution layers (where filters are made to scan the input to the respective layer) which play a vital role in the process of feature extraction. There are multiple architectures of CNNs used in related works. Our model was inspired by the VGG-16 architecture to which we made slight modifications. The VGG-16 architecture performed well in the ImageNet challenge, and it possesses a good depth of the network while retaining the structure’s simplicity. 
We made some slight modifications to the VGG-16 architecture. The network has 16 layers in total - 13 convolution layers and 3 fully connected layers. The original VGG-16 architecture makes use of a stride of 1 in the convolutional layer filters and a max-pooling layer with a stride of 2 which halves the dimensions. We, however, decided to go with a stride of 3 for the convolutional layer filters and a stride of 1 for the max-pooling layer while retaining the sizes to be 3*3 and 2*2 respectively for the two layers, the reasons being - a larger stride length leads to more generalisation and lesser overfitting which seems to be a major problem in the case of CNNs and image classification. We also chose a stride of 1 for the max-pooling layer to not reduce the dimensions (as that is already being done in the convolutional layers due to an increased stride) and highlight the strongest features only.  The general approach is to choose a stride of 1 for the convolutional layer filters, which we also tried but we ended up getting a negligible change in the performance of the model in exchange for a much larger computational requirements. The general architecture however, remained similar to the original VGG-16. The original architecture has around 138 million parameters, while our model had around 33 million trainable parameters, with almost the same level of performance, and was much faster to train. We used ReLu (Rectified Linear Unit) as our activation function in the convolution layers and a Sigmoid activation function in the output layer which contains 37 units in accordance to the 37 features as per the decision tree considered [21].

## DECISION TREE
The decision tree considered presents the guidelines for measuring finer morphological features [21]. It stems from a citizen science crowdsourcing project where thousands of volunteers were asked to manually classify the galaxies based on 11 questions. There are 37 nodes or a total of 37 finer features that could characterise the galaxy. The output of the CNN’s final layer gives the probabilities of all the 37 features. The task at hand was to identify the answers to all the 11 questions by determining the features having maximum probability under each class (question). Once the strongest features are determined, they are presented as the physical features that characterise the input galaxy image that is uploaded by the user on the client-side interface. Each question’s answer (the one with the maximum probability), determines the flow the tree. So the decision tree was coded as a function to which the data frame containing all the 37 answers’ probabilities was given as the input. The output of the function was a list of morphological features that characterise the galaxy as per the decision tree. 

## CONCLUSION AND FUTURE SCOPE
The deeper understanding of the dynamical history of galaxies is aided by the powerful probe of morphological parameters. Visual inspection for the identification of characteristic physical features of galaxies is impractical for astrophysicists. Our work presents a method of automating  the process of determining the morphological features that characterise a galaxy with the use of Convolutional Neural Networks. The Galaxy Zoo dataset was resized and augmented, followed by the application of median filtering and contrast limited adaptive histogram equalisation. The processed images were then fed into a CNN based on the VGG-16 architecture. After the training of 10 models, the final model with the best combination of hyper parameters gave a mean square error of 0.0102 on processed images. The morphological features were then determined by the features having the maximum probabilities under each class or question. The model was then deployed onto a client-side interface using Flask where the user could upload an image of a galaxy and get a list of morphological features that characterise the galaxy as the output in real-time.   
There are many secondary objects present in some images, so the scale can be reduced to see if it helps focus on the features of the galaxy under consideration, or segmentation algorithms for
galaxies lacking distinct boundaries can be used. Many more data augmentation methods can be used. Techniques like flipping, translation, brightness/contrast changing etc. can be performed. Other architectures of CNNs like ResNet, AlexNet etc can be used to see if they perform any better. 
We have approached this problem as a multi-regression problem, but the probabilities of the features are not independent.  Each question’s answers apart from the first one, depends on a previous question’s answer. We believe that utilising this constraint will lead to better results.


